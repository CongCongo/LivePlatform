stages: 
    - build
    - test
cache:
    paths:
        - node_modules/

buildJob:
    stage: build
    script:
        - pip3 install -r requirements.txt
        - cd frontend/ 
        - cnpm install
        - cnpm run build

testJob:
    stage: test
    script:
        - cd frontend/
        - cnpm install
        - cnpm uninstall phantomjs-prebuilt
        - cnpm install phantomjs-prebuilt==2.1.7
        - cnpm run unit
        - cd ..
        - ./manage.py test